### 模块机制

#### CommonJS的模块规范
- 模块引用：通过`require()`方法引用
- 模块定义：上下文提供了`exports`对象用于导出当前模块的方法和变量，并且它是唯一导出的出口。
   在模块中，还存在一个`module`对象，它代表模块本身，而exports是module属性
- 模块标识：传递给`require()`方法的参数，必须是符合小驼峰命名的字符串，或者相对路径、绝对路径
``` javascript
// math.js
exports.add = function (i, j) {
  return i + j
}

// promgram.js
const math = require('math')
exports.increment = function (val) {
  return math.add(val, 1)
} 
```
   
#### Node的模块实现
- 在Node中，模块分为两类：
   1. 核心模块：Node提供的模块
   2. 文件模块：用户编写的模块

- Node模块加载的步骤
   1. 路径分析
   2. 文件定位
   3. 编译执行

- 模块的加载顺序
   1. 缓存加载：Node对引入过的模块都会进行缓存（编译和执行之后的对象），以减少二次引入时的开销，且核心模块的缓存检查先于文件模块的缓存检查
   2. 部分核心模块：Node进程启动时，部分核心模块就被直接加载进内存中，所以这部分核心模块引入时，忽略文件定位和编译，并且在路径分析中优先判断，所以加载速度是最快的
   3. 文件模块：动态加载，需要完整的加载步骤

#### 模块加载过程
- 路径分析
   1. 模块标识符分析，分为下面几类
      - 核心模块：如http、fs、path，直接加载
      - 路径形式的文件模块：`require`方法将路径转为真实路径，并以真实路径作为索引
      - 非路径形式的文件模块：
         1.


   
   